<div class="page almacen-detail">
  <a routerLink="/almacenes" class="back">‚Üê Volver a almacenes</a>
  <h1><span class="page-icon">üì¶</span> Productos en almac√©n</h1>
  <div class="table-filter">
    <input type="text" [(ngModel)]="filterProductos" (input)="currentPage = 1" placeholder="Buscar por producto..." />
  </div>
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Stock actual</th>
          <th>Stock m√≠nimo</th>
          <th>Punto reorden</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        @if (productosFiltrados.length === 0 && !loading) {
          <tr><td colspan="5" class="empty">No hay productos en este almac√©n</td></tr>
        }
        @for (p of productosPaginados; track p.producto_almacen_id) {
          <tr>
            <td>{{ p.descripcion || p.producto_nombre || p.producto_id }}</td>
            <td>{{ p.stock_actual }}</td>
            <td>{{ p.stock_minimo }}</td>
            <td>{{ p.punto_reorden }}</td>
            <td>
              <a [routerLink]="['/productos']" [queryParams]="{ stock: p.producto_id }" class="btn-small" title="Ir a actualizar stock">Ver</a>
            </td>
          </tr>
        }
      </tbody>
    </table>
    @if (productosFiltrados.length > pageSize) {
      <div class="pagination-wrapper">
        <div class="pagination">
          <button (click)="currentPage = 1" [disabled]="currentPage === 1">¬´</button>
          <button (click)="currentPage = currentPage - 1" [disabled]="currentPage === 1">‚Äπ</button>
          <span>P√°gina {{ currentPage }} de {{ totalPages }}</span>
          <button (click)="currentPage = currentPage + 1" [disabled]="currentPage === totalPages">‚Ä∫</button>
          <button (click)="currentPage = totalPages" [disabled]="currentPage === totalPages">¬ª</button>
        </div>
      </div>
    }
  </div>
</div>
